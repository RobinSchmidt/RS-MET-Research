This code is from:
https://bartipan.net/vmath/