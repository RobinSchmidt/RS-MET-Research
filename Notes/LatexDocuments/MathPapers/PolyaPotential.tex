%\documentclass[12pt, twocolumn]{article}
\documentclass[12pt]{article}
%\documentclass[12pt]{scrartcl}  % to make \subtitle work
%\usepackage{fullpage}           % makes all margins 1 inch?
\topmargin=-1.0cm
\textheight=23cm
\evensidemargin=-1.0cm
\oddsidemargin=-1.0cm
\textwidth=19cm
\setcounter{secnumdepth}{-1}     % suppress numbering of sections
\usepackage{amsmath}
\usepackage{amssymb}             % for mathbb
%\usepackage[latin1]{inputenc}   % why?
\usepackage{graphicx}
\usepackage{float}               % for positioning graphics via [h!]
\usepackage{pstricks}
%\usepackage{pst-plot}
\usepackage{hyperref}            % for hyperlinks
%\usepackage{booktabs}
%\usepackage{fancyhdr}           % for headers and footers
%\usepackage{caption}
\usepackage{subcaption}

%\pagestyle{fancy} 
%\rhead{}
%\rfoot{article available at: \htmladdnormallink{www.rs-met.com}{http://www.rs-met.com}}

% set the footer:
%\rfoot{http://www.rs-met.com}

\begin{document}

% formatting:
\parindent=0in
\parskip=0pt
\pagenumbering{roman}

% main text
\pagenumbering{arabic} \setcounter{page}{1}

\title{The Polya Potential of Analytic Functions [DRAFT]\\ {\Large A New(?) Tool for Visualization, Analysis and Intuition Building}}
%\subtitle{(Subtitle)}
\author{Robin Schmidt}
\maketitle

\section{Preview}
In this paper, I propose a way to boil down the 4D information content of analytic functions into a 3D object without any loss of information. The key to this is the observation that analytic functions satisfy the Cauchy-Riemann equations which implies that their so called Polya vector fields are potential fields. A potential field is a vector field that can be obtained from a scalar field, called its potential, by way of taking partial derivatives. It turns out that the Cauchy-Riemann equations imply that the Polya vector field of an analytic function is indeed such a special potential field. We can therefore construct the potential of the Polya vector field which I will call the "Polya potential". Such a Polya potential is a function $P: \mathbb{R}^2 \rightarrow \mathbb{R}$, i.e. a function with two real inputs and one real output - all in all an object that lives in 3D space rather than in 4D as the original complex function does. It is therefore simpler than the original 4D function and easier to visualize. Yet, it contains the full information. We can always reconstruct our original complex function from it. I propose to make that Polya potential an object of investigation and I hope that, besides helping in visualizing complex functions, it may also suggest new ways of analyzing them. I'm not sure, if that idea is any new - but if it isn't, then information about that is not so easy to find on the internet (or my search skills are lacking). The Polya vector fields seem to be moderately well known - but their potentials seem to be, so far, largely ignored. I propose that we should take a closer look at them. To facilitate this, I will derive expressions for the Polya potentials of many important elementary functions, state some rules for how to derive such expressions for more complicated functions when they are expressed as power series and I'll explain how to interpret plots of such Polya potentials. 

\section{Analytic Functions}
Complex functions $f$ are functions that map a complex number $z$ to another complex number $w$. We will write this as $w = f(z)$. Both, input $z$ and output $w$, are two-dimensional entities such that plotting the graph of such a complex function $f$ would require four dimensions. That makes visualization of complex functions challenging for us lowly creatures that inhabit a 3D space. However, most complex functions of interest have a special property that allows us to boil these 4D objects down to 3D objects without any loss of information. That property is called "analyticity" also known as "holomorphy". These two terms are actually defined differently but in the context of complex analysis they imply each other, so they are often used interchangably [VERIFY!]. If we consider only functions that are analytic (or holomorphic), we are dealing with an important subset of all possible complex functions $f: \mathbb{C} \rightarrow \mathbb{C}$. That subset is so rigidly constrained that it is actually possible to construct a function $P: \mathbb{R}^2 \rightarrow \mathbb{R}$ that captures the full information content of our original $f$. This "rigidity" of analytic functions is captured in the  Cauchy-Riemann equations which relate real and imaginary part of a complex function in a way that severely constrains, what the analytic function can do. It is this rigidity that we exploit to boil down a 4D object into a 3D object without information loss.

\section{Polya Vector Fields}
When we interpret the complex conjugate of a complex function $f$ as a vector field, we obtain the so called Polya vector field that is associated with the complex function. Due to the analyticity of $f$, this vector field will be potential field. That means, there exists a scalar field, called a potential, such that the vector field can be obtained from it by taking partial derivatives. More formally, the Polya vector field of a complex function $f = f(z): \mathbb{C} \rightarrow \mathbb{C}$, is a 2D vector field, i.e. a function $(u(x,y), v(x,y)): \mathbb{R}^2 \rightarrow \mathbb{R}^2$ that is obtained from the complex function $f$ by using $u(x,y) = \Re(f), v(x,y) = -\Im(f)$ where $x = \Re(z), y = \Im(z)$. Negating the imaginary part of $f$ in the definition $v$ has the effect of turning the Cauchy-Riemann conditions for analytic complex functions into the condition that makes the Polya vector field curl-free (by virtue of $u_y = v_x$) and divergence-free (by virtue of $u_x = - v_y$). To avoid confusion, note that in my notation here, I use $v(x,y) = -\Im(f)$ whereas in a typical complex analysis textbook, you're are more likely to see things like $f(z) = f(x + \i y) = u(x,y) + \i v(x,y)$, i.e. $v(x,y) = \Im(f)$. Without the negation, the Cauchy-Riemann equations would look like $u_x = v_y, u_y = -v_x$ and that's how you'll see them in textbooks. But for our purposes here, where we are dealing with the Polya vector field, it is more convenient to have the negation already baked into $v$. So, the Cauchy-Riemann equations look like $u_x = -v_y, u_y = v_x$ with our notation here. The curl-free condition $u_y = v_x$ makes the Jacobian of the Polya vector field symmetric and in turn, a symmetric Jacobian is a necessary and sufficient condition for the vector field to be a gradient field, i.e. a vector field that can be obtained from a scalar field by the operation of taking its gradient. Symmetry of the Jacobian is in itself already enough to make the vector field a gradient field. But we have a further constraint: the divergence-free property $u_x = -v_y$ lets our Jacobian have a trace (sum of diagonal elements) of zero. Our vector field is not just any arbitrary gradient field but a very special kind of gradient field - namely, one that is additionally divergence-free\footnote{I think, this divergence-free property is the reason why all stationary points of the Polya potential are saddles (at least, those I have seen so far). [Figure out! Do sources in the vector field correspond to maxima in the potential and sinks to minima? I think so.]}. This latter feature is not a necessary condition for the existence of a potential. It is an additional constraint on top of it, so we are really only looking on a subset of all possible potential fields here.

\section{Polya Potentials}
In general, a potential $P(x,y)$ for a given 2D vector field $u(x,y), v(x,y)$ is a scalar field whose partial derivatives with respect to $x$ and $y$ are equal to our two given bivariate functions $u$ and $v$ that define our vector field. That means $P$ must be such that $u = P_x = \partial P / \partial x$ and $v = P_y = \partial P / \partial v$. Our intention here is, of course, to let $u,v$ be the real and negated imaginary part of a complex function $f(z) = f(x + \i y)$, i.e. the Polya vector field of $f$. The potential for the Polya vector field of a complex function $f(z)$ is what I call the "Polya potential" of the complex function $f$. So, given $u$ and $v$ and assuming that $u,v$ indeed define a potential field, how do we find a potential $P(x,y)$ for our pair of bivariate functions? The equation $u = P_x$ suggests that to  find $P$, we might integrate $u$ with respect to $x$. In the following, "with respect to" will be abbreviated as "wrt". Let's call the integral of $u$ wrt $x$ by the letter $U = U(x,y)$. Also, the equation $v = P_y$ suggests that we might integrate $v$ wrt $y$. Let's call the result of that $V = V(x,y)$. So - does that mean we can choose either of the two ways and both will give us the same result, i.e. our desired potential $P(x,y)$ is equal to $U(x,y) = V(x,y)$? In some cases, it does indeed work out like that. But there's a little complication: In both integrations, there could be integration constants and these "constants" are actually constant only wrt our integration variable but can depend on the other variable. To take this into account, we may evaluate both of these integrals. If we are lucky, all of their terms that depend on both $x$ and $y$ match but we may get extra terms that depend only on $x$ when integrating $u$ wrt $x$ and other extra terms that depend only on $y$ when integrating $v$ wrt $y$. These "extra terms" are the desired integration "constants". What we have to do is to collect all the common terms that depend on $x$ and $y$ and add to the that the extra terms that depend only on $x$ or only on $y$ from both results to get our final expression for $P(x,y)$. In some cases, these extra terms turn out to be zero but at other times they are not. As a general rule, such extra terms pop up in $U$ whenever $u$ has terms that are independent of $y$, i.e. constant or dependent only on $x$ and they pop up in $V$, whenever $v$ has terms independent of $x$, i.e. constant or dependent only on $y$. This strategy seems to work fine for functions like $z^n, \exp(z), \sin(z), etc.$ but not so much for $\sqrt{z}, \log(z), \arcsin(z), etc.$. In the case of $\log$, the two integrals $U$ and $V$ look totally different and it is not quite clear how to combine them into a potential $P$. In the case of $\sqrt{z}$, the expression for $U$ looks unwieldy and I couldn't even find one for $V$ using SageMath. But I suppose, these problems are more of a technical rather than conceptual nature. We'll see. This will become clearer when we see examples where, for the time being, we will set that problem aside and focus on those cases, where analytic expressions for the the potentials can be found easily. 
%The harder cases shall be postponed or delegated to the real mathematicians.

\section{Polya Vector Fields and Potentials of Basic Functions}
Now we want to build a little inventory of expressions for Polya vector fields and their potentials for some important elementary functions. The way I want to do this is by using a little snippet of SageMath code into which we can plug in our function of interest $f(z)$ and it spits out expressions for the components $u,v$ of the associated Polya vector field and the integrals $U,V$ of $u$ and $v$ with respect to $x$ or $y$ from which we can read off our Polya potential $P(x,y)$ by combining the results of these two integrals appropriately. You can execute that snippet yourself in SageCell \cite{SageCell}. In the example code, we consider the function $f(z) = z^2$.
\begin{verbatim}
var("x y")
assume(x, "real")
assume(y, "real")
z = x + I*y
w = z^2                 # function of interest
u =  w.real() 
v = -w.imag()
U = integral(u, x)
V = integral(v, y)
u, v, U, V	
\end{verbatim}
This produces the result:
\begin{verbatim}
(x^2 - y^2, -2*x*y, 1/3*x^3 - x*y^2, -x*y^2)
\end{verbatim}
In this example, we indeed see that $U$, the integral of $u$ wrt $x$, does indeed contain a term that depends only on $x$ but not on $y$, namlely $x^3/3$. That is the function of $x$ that would have to be added as integration "constant" to $V$ to give the full potential. The term that depends on both $x$ and $y$, namely $-x y^2$, is the same in $U$ and $V$, as it should be. So, we found the desired expressions for our Polya vector field and its potential for the complex function $f(z) = z^2$. They are:
\begin{equation}
f(z) = z^2 \quad \Rightarrow \quad
u(x,y) = x^2 - y^2, \; 
v(x,y) = -2 x y, \quad 
P(x,y) = \frac{x^3}{3} -x y^2
\end{equation}
Replacing the line \texttt{w = z\textasciicircum2 } by some other function, say, \texttt{w = exp(z)}, we can get the expressions for other functions of interest. For $f(z) = e^z$, the result is:
\begin{verbatim}
(cos(y)*e^x, -e^x*sin(y), cos(y)*e^x, cos(y)*e^x)
\end{verbatim}
so we have:
\begin{equation}
f(z) = e^z \quad \Rightarrow \quad
u(x,y) =  e^x \cos(y), \; 
v(x,y) = -e^x \sin(y), \quad 
P(x,y) =  e^x \cos(y)
\end{equation}
In this case, $U$ and $V$ were indeed exactly equal and we didn't have to collect any extra terms for the integration constants, i.e. the correct integration constants turned out to be zero. Of course, we could still add true constants that depend neither on $x$ nor on $y$ to our final expression $P(x,y)$. That is a consequence of the fact that a potential for a given vector field is generally uniquely determined only up to an additive constant. This issue might become important, if you are dealing with different representations of the same function. For example, the Riemann zeta function can be expressed in multiple different ways. In such cases, it may make sense to pin down the integration constant by prescribing a specific function value for $P(x,y)$ at a specific point $(x,y)$, for example by requiring $P(0,0) = 0$. For the time being, we'll just take that additive constant to be zero, though. Continuing like this, we can build the following table:
\begin{center}
\begin{tabular}{ |p{1cm}|p{3cm}|p{3cm}|p{6cm}|  }
\hline
$f(z)$     & $u(x,y)$           & $v(x,y)$            & $P(x,y)$  \\
\hline
$a + \i b$ & $a$                & $-b$                & $a x - b y $                    \\
$z$        & $x$                & $-y$                & $(x^2 - y^2)/2 $                \\
$z^2$      & $x^2 - y^2$        & $-2xy$              & $x^3/3 - xy^2 $                 \\
$z^3$      & $x^3 - 3 x y^2$    & $-3 x^2 y + y^3$    & $x^4/4 - 3 x^2 y^2 / 2 + y^4/4$ \\
$1/z$      & $x/(x^2 + y^2)$    & $y/(x^2 + y^2)$     & $\ln(x^2+y^2)/2$                \\
$e^z$      & $e^x \cos(y)$      & $-e^x \sin(y)$      & $e^x \cos(y) $                  \\
$\sin(z)$  & $\sin(x) \cosh(y)$ & $-\cos(x) \sinh(y)$ & $-\cos(x) \cosh(y)$             \\
$\cos(z)$  & $\cos(x) \cosh(y)$ & $\sin(x) \sinh(y)$  & $ \sin(x) \cosh(y)$             \\
$\tan(z)$  & $ \frac{\sin(2x)}{\cos(2x) + \cosh(2y)}$              
           & $\frac{-\sinh(2y)}{\cos(2x) + \cosh(2y)}$               
           & $(-1/2) \log(\cos(2x) + \cosh(2y))$             \\
%$...$      & $...$              & $...$               & $...$             \\
\hline
\end{tabular}
\end{center}
% tan(z):
% sin(2*x)/(cos(2*x) + cosh(2*y)), -sinh(2*y)/(cos(2*x) + cosh(2*y)),
% -1/2*log(cos(2*x) + cosh(2*y)), -1/2*log(cos(2*x) + cosh(2*y))

...TBC...Verify formulas (also numerically). Maybe add sinh, cosh, tanh, Moebius-trafo \newline
% It's interesting to note that for e^z, we have u(x,y) = P(x,y). The potential equals the real
% part.

% Make tables of:
% -small powers of z including 0,1,2,3,4,5,6,7,8  include f(z) = c = a + i b = const
% -small negative powers of z: -1,-2,-3,-4,-5
% -f(z) = a z + b for complex a,b
% -f(z) = (a z + b) / (c z + d) for complex a,b,c,d
% -exponential: exp, pow, exp(i*z) -> important for Fourier series
% -trig: sin, cos, tan, 1/tan = cos/sin, 1/sin, 1/cos
% -hyp: sinh, cosh, tanh, ...
% -inverses: log, atan, asin %  ...for log it looks complicated, see .txt file
% -If the table grows large, maybe split into powers, trig-funcs, exp/sinh/cosh/log

\subsection{Positive Integer Powers}
We now want to derive expressions for the Polya vector field and potential a general positive integer power, i.e. for functions of the form $f(z) = z^n$. Setting $z = x + \i y$ and expanding $z^n$ according to the binomial theorem, we get:
\begin{equation}
	z^n = (x + \i y)^n = \sum_{k=0}^n \binom{n}{k}  x^k (\i y)^{n-k}
\end{equation}
To see what that means in terms of real and imaginary part of the result of $z^n$, we'll again use a little snippet of Sage code where we can tweak \texttt{n} and inspect the results:
\begin{verbatim}
n = 5	               # You may tweak this parameter
var("x y")
assume(x, "real")
assume(y, "real")
z = x + I*y
w = z^n
w.real(), w.imag()
\end{verbatim}
This code gives the following results for \texttt{n = 0..7}:
\begin{verbatim}
n  Real                                      Imag
0: 1,                                        0 
1: x,                                        y
2: x^2 - y^2,                                2*x*y
3: x^3 - 3*x*y^2,                            3*x^2*y - y^3
4: x^4 - 6*x^2*y^2  + y^4,                   4*x^3*y - 4*x*y^3
5: x^5 - 10*x^3*y^2 + 5*x*y^4,               5*x^4*y - 10*x^2*y^3 + y^5
6: x^6 - 15*x^4*y^2 + 15*x^2*y^4 - y^6,      6*x^5*y - 20*x^3*y^3 + 6*x*y^5
7: x^7 - 21*x^5*y^2 + 35*x^3*y^4 - 7*x*y^6,  7*x^6*y - 35*x^4*y^3 + 21*x^2*y^5 - y^7
\end{verbatim}
Note that here, we have not yet negated the imaginary parts, so we'll have to do that later. We always take binomial coeffs from the $n$-th line of Pascal's triangle. The coeffs of each line go alternatingly into the real and imaginary part. Within these parts, there's also a sign alternation. They multiply terms of the form $x^k y^{n-k}$ where $k$ starts at $n$ in the real part and at $n-1$ in the imaginary part and decrements by $2$ from term to term. We can make general formulas from these observations (these formulas aren't supposed to be obvious and took me quite a while to figure out):
\begin{equation}
\label{Eq:PolyaFieldPositivePowers}
\boxed{		
	u_n(x,y) = \sum_{k=0}^{n/2} (-1)^k \binom{n}{2 k} x^{n-2k} y^{2k}
	,\qquad
	v_n(x,y) = -\sum_{k=0}^{(n-1)/2} (-1)^k \binom{n}{2k+1} x^{n-(2k+1)} y^{2k+1}
}
\end{equation}
So, these are the $u_n(x,y), v_n(x,y)$ parts of the Polya vector field of a single term $z^n = (x + \i y)^n$ for $n \geq 0$. The upper summation limits are understood to be meant in the sense of integer division, i.e. if the result of the division by 2 is a non-integer, it will be rounded down towards zero. There is a little complication for the edge case of $n=0$ for $v_n$, i.e. for $v_0(x,y)$. In this case, the sum would formally run from $0$ to $-1/2$. Due to the integer division behavior, it actually runs from $0$ to $0$, i.e. produces exactly one term for $k=0$ which according to the formula turns out to be $v_0(x,y) = 0 x^{-1} y^1$ if we assume the 0-choose-1 binomial coefficient to be zero, which is the common convention. This result is actually kinda correct mathematically - we just want $v_0(x,y)$ to be the zero function. But when coding this stuff up, we need to be careful to treat this edge case correctly because it doesn't really fit the pattern of an $x^n y^m$ term for $n,m \geq 0$. In a coding context that works with bivariate polynomials, we might probably want to express the zero function as $v_0(x,y) = 0 x^0 y^0$ instead of $v_0(x,y) = 0 x^{-1} y^1$. Either way, the function is identically zero. The math doesn't care. An implementation of bivariate polynomials might be unable to digest the $x^{-1}$ factor (mine certainly doesn't - ToDo: give reference with link to the implementation).

\medskip
To find the potential for the $z^n$ terms, we'll need to take (\ref{Eq:PolyaFieldPositivePowers}) and integrate $u_n(x,y)$ wrt $x$ and $v_n(x,y)$ wrt to $y$. We'll call the integration results $U_n, V_n$ respectively. The functions $u,v$ are just simple bivariate polynomials, so integrating wrt to $x$ involves incrementing the $x$-exponents in all terms by one and dividing the terms by their new exponents. Same story for $y$. This gives:
\begin{equation}
U_n(x,y) = \sum_{k=0}^{n/2} \binom{n}{2 k} \frac{(-1)^k x^{n-2k+1} y^{2k}}{n-2k+1}
,\qquad
V_n(x,y) = -\sum_{k=0}^{(n-1)/2} \binom{n}{2k+1} \frac{(-1)^k x^{n-(2k+1)} y^{2k+2}}{2k+2}
\end{equation}
When doing these integrations, all the terms that involve both $x$ and $y$ match in both of these integrals. But if $u$ contains terms that don't depend on $y$, i.e. a constant term and/or terms that only have $x$ in them but no $y$, then the integral of $u$ wrt $x$ may contain some etxra terms that only depend on $x$ and don't appear in the integral of $v$ wrt $y$. Likewise, if $v$ has terms that don't depend on $x$, they will give rise to terms that only depend on $y$ in the integral of $v$ wrt to $y$ which do not show up in the integral of $u$ wrt $x$. Such additional terms in either of these integrals can be regarded as integration constants - they are constant with respect to our integration variable but may depend on the other variable.

\medskip
We can in general just always use $V_n(x,y)$ and add to it a $x^{n+1}/(n+1)$ term as integration constant because all the $u_n$ have exactly one term that is independent of $y$ and that term is always $x^n$ (see the Sage output) which, when integrated, gives $x^{n+1}/(n+1)$. That gives:
\begin{equation}
\label{Eq:PolyaPotentialPositivePowers}	
\boxed{	
	P_n(x,y) = \frac{x^{n+1}}{n+1} 
	-\sum_{k=0}^{(n-1)/2} \binom{n}{2k+1} \frac{(-1)^k x^{n-(2k+1)} y^{2k+2}}{2k+2}
}
\end{equation}

\subsection{Negative Integer Powers}
Let's now derive expressions for the Polya vector field and potential of a general negative integer power, i.e. for functions of the form $f(z) = 1/z^n = z^{-n}$. We will again try a couple of examples and try to spot the patterns. We'll use this script:
\begin{verbatim}
n = 3                     # exponent without the minus sign
var("x y")
assume(x, "real")
assume(y, "real")
z = x + I*y
w = 1 / z^n               # function of interest
u =  w.real() 
v = -w.imag()
U = integral(u, x)
V = integral(v, y)
u, v, U, V
\end{verbatim}
% This is actually almost the same code as already shown above. Duplication! Remove!
This code produces the result:
\begin{verbatim}
u = (x^3 - 3*x*y^2)/((x^3 - 3*x*y^2)^2 + (3*x^2*y - y^3)^2)
v = (3*x^2*y - y^3)/((x^3 - 3*x*y^2)^2 + (3*x^2*y - y^3)^2)
U = V = -1/2*(x^2 - y^2)/(x^4 + 2*x^2*y^2 + y^4)
\end{verbatim}
We observe that for $u$ and $v$, we get rational functions with equal denominators. Let's produce more results for \texttt{n = 2..6} and look at the numerators of $u$ and $v$ as well as at the common denominators. Numerators first:
\begin{verbatim}
n  Numerator of u                                  Numerator of v
2  x^2 - y^2                                       2*x*y                         
3  x^3 - 3*x*y^2                                   3*x^2*y - y^3                  
4  x^4 - 6*x^2*y^2  + y^4                          4*x^3*y - 4*x*y^3
5  x^5 - 10*x^3*y^2 + 5*x*y^4                      5*x^4*y - 10*x^2*y^3 + y^5
6  x^6 - 15*x^4*y^2 + 15*x^2*y^4 - y^6             6*x^5*y - 20*x^3*y^3 + 6*x*y^5
\end{verbatim}
The denominators are:
\begin{verbatim}
n  Denominator
2  (x^2 - y^2)^2                           +  4*x^2*y^2
3  (x^3 - 3*x*y^2)^2                       + (3*x^2*y - y^3)^2
4  (x^4 - 6*x^2*y^2 + y^4)^2               + 16*(x^3*y - x*y^3)^2
5  (x^5 - 10*x^3*y^2 + 5*x*y^4)^2          + (5*x^4*y - 10*x^2*y^3 + y^5)^2
6  (x^6 - 15*x^4*y^2 + 15*x^2*y^4 - y^6)^2 + 4*(3*x^5*y - 10*x^3*y^3 + 3*x*y^5)^2
\end{verbatim}
And finally, the potentials:
\begin{verbatim}
n  Potential
2  -x / (x^2 + y^2)
3  -1/2*(x^2 - y^2) / (x^4 + 2*x^2*y^2 + y^4)
4  -1/3*(x^3 - 3*x*y^2) / (x^6 + 3*x^4*y^2 + 3*x^2*y^4 + y^6)
5  -1/4*(x^4 - 6*x^2*y^2 + y^4) / (x^8 + 4*x^6*y^2 + 6*x^4*y^4 + 4*x^2*y^6 + y^8)
6  -1/5*(x^5 - 10*x^3*y^2 + 5*x*y^4)  / 
        (x^10 + 5*x^8*y^2 + 10*x^6*y^4 + 10*x^4*y^6 + 5*x^2*y^8 + y^10)
\end{verbatim}
The numerators of real and imaginary parts are exactly as in the corresponding positive powers of $z$ and the denominator is always $u^2 + v^2$. In the potential, the denominator is $(x^2 + y^2)^{n-1}$. And the numerator of the $n$-th line is the same as the real part of the $(n-1)$-th line and the whole thing is divided by $n-1$?  So, the general formulas for the Polya vector field and potential for $f(z) = 1/z^n$ are:
\begin{equation}
\label{Eq:PolyaFieldNegativePowers}
\boxed
{		
u_{-n}(x,y) = \frac{u_n}{u_n^2 + v_n^2} ,\;
v_{-n}(x,y) = \frac{v_n}{u_n^2 + v_n^2} ,\quad
P_{-n}(x,y) = \frac{-u_{n-1}}{(n-1)(x^2+y^2)^{n-1}}
}
\end{equation}
where $u_n, v_n$ are the expressions for the corresponding positive power. It turns out that the case for $n=1$ doesn't follow the pattern, so we treat it separately. The result is actually already included in the table further above. It's $\ln(x^2+y^2)/2$. The reciprocation function $f(z) = 1/z = z^{-1}$ is a very special citizen in complex (and real) analysis anyway.

%[Maybe move the Sage derivations into an appendix and keep only the results in the main text. Refer to the implementation of the formulas]

%\section{Plotting the Polya Potentials and Interpreting the Plots}
\section{Interpreting Plots of Polya Potentials}
\subsection{Plots for $f(z) = z^2$}
One of the main goals of this investigation is to provide a new way of visualizing complex functions, so we shall now look at some plots. As a first example, we will have a look at the function $f(z) = z^2$. In figure \ref{Fig:SquareSurface}, we see the Polya potential of $f(z) = z^2$, which is given by $P(x,y) = x^3/3 - x y^2$, drawn as a surface above the $xy$-plane. The height is also color coded according to the scale that appears next to the plot. 
\begin{figure}[h]
\caption{Polya potential surface $P(x,y) = x^3/3 - x y^2$ of the function $f(z) = z^2$}	
\label{Fig:SquareSurface}	
\centering
\includegraphics[width=1.0\textwidth]{../MathFigures/PolyaSurfacePow2.png}
\end{figure}
% Maybe we should have axis labels for the x-and y-axis!
% It's important to define the label below the caption. Otherwise, there will be just be a [??] in the text for the reference.
Let's analyze some important features of that surface to develop some intuition, how to interpret such plots. The $x$-axis goes from top-left to bottom-right and the $y$-axis from bottom-left to top-right. When we move on the surface with increasing $x$-values along the $y=0$ line, we climb up from a low height, then reach some saddle at $(0,0)$ and then start climbing again. The direction of steepest ascent, i.e. the gradient, points exactly along our direction of movement. When we move along the $x$-axis for $y=0$, we precisely follow the direction of the gradient. That is to say, the gradient always points into the positive $x$-direction, except for the single point $(0,0)$ where it momentarily vanishes. This behavior can also be seen from the plot of the Polya vector field in the left of figure \ref{Fig:SquareVectorsAndContours}. 
\begin{figure}[h]
%\vspace*{-1cm}	
\caption{Polya vector field and Polya potential contours of $f(z) = z^2$}	
\label{Fig:SquareVectorsAndContours}
%\vspace*{-6mm}
\centering
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaVectorsPow2.png} 
% maybe use the denser variant of the pic
\end{subfigure}
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursPow2.png}
\end{subfigure}
%\caption{\vspace{2cm} titleoffigure}
\end{figure}
% I try to move the caption closer to the plot. the problem is that the plot itself has some top-margin. I would like to draw the caption over the white background color of plot image. Unfortunately, LaTeX draws the caption first and then the plot such that the plot covers the text.
% https://latex-tutorial.com/caption-customization-latex/
% https://en.wikibooks.org/wiki/LaTeX/Floats,_Figures_and_Captions
% hmm..it still doesn't look good. Maybe we need to post-process the actual images such that they
% do not have any top margin by themselves...or: produce them without top-margin in the first place

\medskip
In this type of plot, to make the vector field plot more readable, the lengths of all the arrows are normalized and how long they actually should be is indicated by the strength of the coloring. Remember that the Polya vector field \emph{is} the gradient of the Polya potential surface. Along the center horizontal line where $y=0$, the arrows always point to the right, i.e. in the direction of the positive $x$-axis. We interpret this as follows: when the input to $P(x,y)$ is of the form $(x,0)$, then the gradient will point into some horizontal direction $(a,0)$ where $a$ is always positive except at $(0,0)$ where $a=0$. More quantitatively, $a=x^2$ which is the partial derivative wrt $x$ of $P(x,y) = x^3/3 - x y^2$ along the line where $y=0$. The surface for $f(z) = z^2$ given by $P(x,y) = x^3/3 - x y^2$ is, up to a scale factor, actually well known: it is called the monkey saddle, see \cite{MonkeySaddleWiki}. In contrast to a regular saddle, which provides channels for the two legs of a horseman, the monkey saddle also provides an additional third channel for the tail of the monkey. In the plot of the contour map on the right of figure \ref{Fig:SquareVectorsAndContours}, we notice that wherever a contour line has a vertical segment, the corresponding arrow of the vector field is horizontal. This can also be seen as a consequence of the fact that on any surface described by a bivariate function $P(x,y)$, the gradient is always orthogonal to the lines of constant height, i.e. the contour lines. This fact gives us a general rule for how to interpret contour map plots such as the one in the right of figure \ref{Fig:SquareVectorsAndContours}: wherever we see contour lines densely bunched together, there is a steep gradient - that is: a gradient with high absolute value. That translates to a high magnitude of $f(z)$ at that point. The direction of that gradient (steep or not) is always perpendicular to the contour line at the given point. From the two possible perpendicular directions, it's the one that points upward, i.e. toward increasing $P$-values. In our plots here, that means into the direction of more reddish colors. This direction gives us the (negative) angle of $f(z)$ [VERIFY!]. There is another subset of the plane where the arrows are purely horizontal and therefore the outputs of $f(z)$ purely real. It is the $y$-axis. But along this axis, all the arrows point to the left which indicates a negative real value. Up to now, we have identified the part of the domain, where the output of $f(z) = z^2$ is purely real, i.e. the gradient of $P(x,y)$ is horizontal. The parts of the domain where this happens are precisely the $x$- and $y$-axis. Along the $x$-axis, the gradient points to the right indicating a positive real part of $f(z)$ and along the $y$-axis, the gradient points to the left indicating a negative real part of $f(z)$. Along these axes, the imaginary part of $f(z)$ is zero. 

\medskip
Let's now identify the part of the domain where the gradient is vertical meaning that the output of $f(z)$ is purely imaginary. This is most easily identified in the vector field plot in the left of figure \ref{Fig:SquareVectorsAndContours}. Purely vertical arrows occur along the diagonals. Look at the diagonal going from the top-left to the bottom-right. Along this diagonal, all the arrows point upward. Remembering that the Polya vector field is the complex conjugate of our actual $f(z)$, i.e. involves a negation of the imaginary part, we may conclude that along this diagonal, $f(z)$ is purely imaginary with negative imaginary part. Likewise, along the diagonal from the bottom-left to the top-right, we see downward pointing arrows indicating a positive purely imaginary value in $f(z)$. Focus on the arrow emanating from $(x,y) = (0.5,0.5)$. It points straight downward. Let's compute $w = f(z) = z^2$ at $z = (1 + \i) / 2$ which is the complex number corresponding to this point. The result is $w = \i / 2$ which has an absolute value of $0.5$. Looking at the color scale next to the arrow plot and comparing the color at 0.5 on the scale to the color of the arrow at coordinates $(0.5,0.5)$, it looks like a match, as it should. ....TBC...

\subsection{General Rules for Interpreting Contour Plots}
In the previous section, we have looked at 3 different ways to plot functions related to $f(z) = z^2$ which encode its behavior completely. We had the surface plot for the Polya potential, the vector field plot for the Polya vector field and the contour map plot for the Polya potential. Any one of these three kinds of plot contains the \emph{full} information about $f(z)$ encoded in different ways. Eventually, we want to settle to only one single type of plot and become proficient in reading it. The one, I want to settle for, is the contour map plot of the Polya potential. We want to train our ability to look at such a plot and understand what $f(z)$ does from that plot. Since the plot contains the full information, it must be possible. However, understanding such a plot from a glance is not nearly as intuitive as understanding a simple plot of a real function. But maybe there's some hope to develop such an intuition with practice. We will first state some general rules.
\begin{itemize}
\item The gradient is always perpendicular to the contour lines and points into the direction of increasing $P$, i.e. towards the red colors.
\item Vertical contour segments correspond to purely real outputs of $f(z)$. This is because they correspond to horizontal arrows for the gradient. If, on crossing such a vertical segment from left to right, the value of $P$ increases (i.e. goes to red), the real output is positive and if $P$ decreases, the real output is negative.
\item Horizontal contour segments correspond to purely imaginary outputs of $f(z)$. This is because they correspond to vertical arrows for the gradient. If, on crossing such a horizontal segment from bottom to top, the value of $P$ increases, the imaginary output is negative and if $P$ decreases, the imaginary output is positive\footnote{The negation in the definition of the Polya vector field inverts the behavior}.
\item The local density of the contour lines indicates the steepness of the gradient at that point. In turn, this steepness corresponds to the absolute value of $f(z)$. Steep gradients result in "strong" arrows, i.e. dark-blue arrows. [ToDo: maybe use a colormap from light-yellow to dark-red for the unipolar color maps in the arrow plot]
\item The local direction of a contour line determines the direction of the gradient at that point. ...TBC...
\end{itemize}
When we want to read such a contour plot, we need two steps of interpretation: (1) We must be able see the arrows from the contours, i.e. mentally translate the contour plot into an arrow plot. (2) interpret these imagined arrows as real and (negated) imaginary part - or better yet: as magnitude and angle - of a complex number. ...TBC...

% we need two skills: (1) see the arrows from the contours, (2) interpret the arrows are real and negated imaginary part...or better: as magnitude and angle

% Can we say something about the angle of $f(z)$ in terms of the contour lines? Maybe it's always the angle of a tangent to the contour line, rotated by 90°? clock- or counterclockwise? I think, we need to take the tangent and rotate it clockwise by 90° to get the gradient. Rotating it counterclockwise instead would give the direction of w = f(z)...I think...verify! ..hmm..nope - that seems to fail at (x,y) = (-0.5,0). There, we would need to rotate clockwise. But at (0,0.5), we need to rotate counterclockwise. Maybe the contour-line information is not enough. We really also nee to look at the colors - where is the blue? We always need to rotate toward blue, I think.

% Maybe we can say that the gradient always points from one contour like to the next and the strength/steepness is inversely proportional to the distance of the next contour when we assume the countours to be equidistant?

% Maybe we can draw in streamlines? in z^2, we have 3 straight streamlines. 1 horizontal, one at 60 and one at 120 degrees

% Remember that strength of coloring indicates, what length the arrow should have if we wouldn't have normalized its length for plotting reasons.

% Rules:
% -vertical contour segments correspond to horizontal arrows and therefor to purely real outputs 
%  of f(z)
% -if on crossing such a vertical segment from left to right, the value of P increases, the real
%  output is positive and if P decreases, the real output is negative
% -horizontal contour segments correspond to vertical arrows and therfore to purely imaginary
%  outputs of f(z)
% -if on crossing such a horizontal segmen from bottom to top, the value of P increases, the 
%  imaginary part is negative and if P decarease, the imaginary part is negative.
% -the density of the contour lines indicates the steepness of the gradient and whic corresponds
%  to the absolute value of $f(z)$. Steep gradients result in "strong" arrows, i.e. dark-blue 
%  arrows. Remember that strength of coloring indicates, what length the arrow should have if
%  we wouldn't have normalized its length for plotting reasons.
% -The gradient is always perpedicular to the contour lines and points into the direction of
%  increasing P, i.e. towards the blue

% ToDo:
% -explain hwo the gradient changes as we move along the unit-circle counterclockwise.The arrow
%  moves clockwise around a circle twice. ...are the arrows really all ona circle, i.e. have
%  all the same length? What if we move around an arbitrary circle rather than the unit
%  circle?

%In figure \ref{Fig:SquareVectorsAndContours}, we see the corresponding Polya vector field together with a contour plot of its Polya potential.


\subsection{Plots for Nonnegative Powers: $f(z) = z^n$}
We now want to look at plots for functions of the form $f(z) = z^n$ for some nonnegative integer $n$. We have already seen that the Polya potential for $f(z) = z^2$ gives us $P(x,y) = x^3/ 3 - x y^2$ which is, up to scaling, the so called monkey saddle. Let's look at some powers other than 2. Let's start with the simplemost cases of the constant function $f(z) = z^0 = 1$ and the identity $f(z) = z^1 = z$. The contour maps for these are shown in figure \ref{Fig:ContoursPow_0_1}. 
\begin{figure}[p]
\caption{Polya potential contours of $f(z) = z^0$ and $f(z) = z^1$}	
\label{Fig:ContoursPow_0_1}	
\centering
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursPow0.png}
\end{subfigure}
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursPow1.png}
\end{subfigure}
\end{figure}

\medskip
In the case of the constant function $f(z) = 1$, we see equidistant vertical lines as contour lines. The upward direction of the function goes to the right which is indicated by having blue colors on the left and red colors on the right. We should try to see the arrows of the gradient field in our heads. In this simple case, our arrows would all point to the right, no matter where in the plane they start and they would all have the same length (or color), namely a length of 1. Would we have chosen a constant different from 1, say $f(z) = c$ for some arbitrary complex number $c$, we would observe the following: For bigger numbers, the contour lines would be more densely packed indicating a steeper gradient and for smaller numbers, they would be more spaced out indicating a shallower gradient. For a negative number, the high (red) values would be to the left and the low (blue) values would be to the right. For a purely imaginary $c$, the contours would be horizontal. If this imaginary number would be positive, red would be at the bottom and blue at the top (mind the negation) and for negative imaginary constants $c$, it would be the other way around. For some completely arbitrary complex number with possibly nonzero real and imaginary part, the contours would be slanted at an angle [ToDo: explain how the angle of the contours is related to the angle of $c$ and the spacing to the magnitude of $c$]. 

\medskip
For the identity function $f(z) = z$, our potential function is given by $P(x,y) = (x^2 - y^2)/2$. That's a parabolic hyperboloid also known as a plain old saddle surface. When we move along a centered horizontal line from left to right, i.e. $y = 0, x \in [-1,+1]$, we first go down (red to yellow) then  up again (yellow to red). We move through a bowl. So, in the left part, our gradient also points to the left and in the right part, it points to the right. This is completely in line from what we expect from the identity function. The gradient always points outward from the origin and it also gets steeper the more we move outward. The further we are away from zero, the bigger the value and the sign of the value matches the sign of our position. Let's now look at a centered vertical line such that $x = 0, y \in [-1,+1]$. We start from low (blue), then move up to yellow and then descend again into the blue. We move over a peak. The arrows would always point inward toward the origin. Now let's have a look at the diagonals. Along these, the gradient always points into a direction perpendicular to our direction of movement. At the origin itself, the gradient is zero. The origin is a flat point of our potential. ...TBC...

\medskip
Let's next look at the potentials for $z^2$ and $z^3$. These are shown in figure \ref{Fig:ContoursPow_2_3}. We have already seen the $z^2$ case, but we will repeat it here to put it into its proper context.
\begin{figure}[p]
\caption{Polya potential contours of $f(z) = z^2$ and $f(z) = z^3$}	
\label{Fig:ContoursPow_2_3}	
\centering
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursPow2.png}
\end{subfigure}
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursPow3.png}
\end{subfigure}
\end{figure}
For $z^2$, we already know that we get the monkey saddle, i.e. a saddle with space for two legs plus a tail. Let's remind ourselves that for $z^1$, we got a regular saddle. It has space for two legs only so it would be suitable for humans. For $z^3$, we get a kind of saddle in which a four legged animal could sit comfortably. Note the different scaling on the color bar for $z^3$. The range is asymmetric here and the zero level is shifted more into the reds because that is the range where the values of $P(x,y)$ happen to fall in when the $x$- and $y$-ranges are both $[-1,+1]$. In this range, the surface goes more down then up because the corners of the plot rectangle happen to coincide with all minima of $P$ and we generally expect more extreme values further away from the origin and the corners are furthest from the origin. That's merely a technical aspect of the plotting and the surface is not generally higher than the others - and even if it would be, that would mean nothing because we are free to add any constant to a potential anyway to shift it up or down to taste. 

% Is it really called "horse saddle"? Maybe "human saddle" makes more sense. The paper about higher
% order saddles calls it the "simple saddle"

% z^3: outward arrows to left,right,top,bottom and inward arrows along the diagonals.

\begin{figure}[p]
\caption{Polya potential contours of $f(z) = z^4$ and $f(z) = z^5$}	
\label{Fig:ContoursPow_4_5}	
\centering
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursPow4.png}
\end{subfigure}
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursPow5.png}
\end{subfigure}
\end{figure}

\medskip
Anyway - we saw that for $z^1$, we got a regular two-leg saddle, for $z^2$ we got a three-leg saddle and for $z^3$ we got a four-leg saddle. A pattern seems to be emerging - and it is indeed true that for $z^n$, our potential surface $P(x,y)$ looks like a saddle surface of order $n+1$. For a discussion of such higher order saddles, see \cite{HighOrderSaddles}. It has also starfish- and octopus-saddles. There is another noteworthy feature of this sequence of saddle surfaces: The higher the order of the saddle, the flatter the interior region near the origin and the steeper the cliffs further away from the origin. This can be seen in figure \ref{Fig:ContoursPow_4_5} where we see saddles of order 5 and 6 - a starfish- and a beetle-saddle (I made the last one up myself). Much of the region around the origin is very flat and only at the boundaries of the plots, the colors actually change a bit to indicate a bit more variability in the height values. In the center region, it's all boringly flat and therefore (almost) one-colored.

\subsection{Plots for Negative Powers: $f(z) = z^{-n}$}
Having seen Polya potentials of positive powers of $z$, the logical next step is to ask how Polya potentials for negative powers of $z$ look like. In figure \ref{Fig:ContoursInvPow_1_2}, we see the contour maps for $1/z$ and $1/z^2$. 
\begin{figure}[p]
\caption{Polya potential contours of $f(z) = 1/z$ and $f(z) = 1/z^2$}	
\label{Fig:ContoursInvPow_1_2}	
\centering
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursInvPow1.png}
\end{subfigure}
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursInvPow2.png}
\end{subfigure}
\end{figure}
They have a very different quality compared to the saddle surfaces that we have seen before. 

\medskip
Let's look at the reciprocal function $f(z) = 1/z = z^{-1}$ first. That means $n=1$ in the format $f(z) = z^{-n}$. The relevant formulas are:
\begin{equation}
f(z)   = \frac{1}{z} \quad \Rightarrow \quad
P(x,y) =  \frac{\ln(x^2+y^2)}{2}
\end{equation}
The first thing we note is that the value of $P$ depends only on $x^2 + y^2$ which is the squared distance from the origin, so we conclude that $P$ must be circularly symmetric - which is what we see in the plot. The second important feature is that the function goes to minus infinity when $z$ goes to zero. There is an infinitely deep hole in the middle and therefore, the plotted range was truncated at $-3$ to get a sensible picture. We see a truncated funnel and the actual funnel would go down to minus infinity at the origin. If we imagine the arrows, they would all point outward from the origin. If we imagine the vector field to be some sort of velocity field of a fluid, it almost looks as if there would be some sort of source at the origin from where stuff flows out. [TODO: explain, why a unipolar colormap is used for this plot]
% The reason for using an unipolar map for this plot in particular is that, as opposed to all the other negative powers, this one does not shoot of to plus *and* minsu infinity in the same symmetric way as all the other powers do. Instead, it seems to sort of level off. But that's also not entirely correct. It doesn't actually level off but rather keeps slooowly (logarithmically) creeping upward to infinity. Still, that's a qualitatively different kind of behavior that having poles that make the funtion shoot off to plus/minus infinity at a finite value. Such an asymmetric behavior with repect to positive and negative values seems not to justify using a bipolar color map. It would give a sense of there being some sort of special central, neutral value which doesn't exist in this case. ....or well, maybe a circle of radius one could qualify?

\medskip
For $f(z) = 1/z^2$, the situation in the plot looks quite different. Here, fluid would be flowing into the origin from the left and just as much fluid flows out of the origin to the right. Again, try to picture the arrows in your head - this is the skill we want to acquire. They always point toward red and they point more strongly when the contour lines are denser. Again, the function values have been cut off at some threshold to get a sensible picture. This time, we have clipped off the values to both ends of the scale, specifically, at $\pm 5$. That means, anything that is greater than $5$ is also represented by full dark red and anything less than $-5$ is drawn dark blue. In reality, the function actually goes to plus and minus infinity at the same time at the origin. Whether it blows up to plus or minus infinity depends on whether we approach the origin from the left or right. But what if we approach it from the top? Let's look at the formulas:
\begin{equation}
f(z)   =  \frac{1}{z^2} \quad \Rightarrow \quad
P(x,y) = -\frac{x}{x^2 + y^2}
\end{equation}
[TODO: explain dipole fields, maybe derive the limits for approaching $0$ from left, right, top and any other direction given by $y = a x$. Maybe plot $P(x)$ for various fixed choices of $a$]
% I think, the limit is +inf fro approach from the left, -inf for approach from the right and zero for approach from all other directions, i.e. a != 0 and a != inf. Maybe we have to take an inner limit of x -> 0 and an outer limit for y -> 0 or something. Anyhow, it seems, we get 3 different limits for the undefined point at the origin.

\medskip
To summarize our observations, for $f(z) = 1/z$, we get a Polya vector field that looks like a point source with field lines pointing outward from the origin. It looks like the potential of a monopole. For $f(z) = 1/z^2$, the Polya vector field looks like a dipole field with field lines pointing into the origin from the left and out of the origin to the right. So, let's see, if we get a tripole and quadrupole for $1/z^3$ and $1/z^4$. The Polya potentials for these functions are shown in figure \ref{Fig:ContoursInvPow_3_4}.
% they flatten out, the further we go away from zero
% they have a singularity at the origin
\begin{figure}[h]
\caption{Polya potential contours of $f(z) = 1/z^3$ and $f(z) = 1/z^4$}	
\label{Fig:ContoursInvPow_3_4}	
\centering
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursInvPow3.png}
\end{subfigure}
\begin{subfigure}[b]{0.49\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursInvPow4.png}
\end{subfigure}
\end{figure}
Well - OK - they may not look like what we may have expected. Instead of a tripole and a quadrupole, we actually get a quadrupole and a hexapole. I don't know, if a tripole is even a thing. Probably not. For the quadrupole, the field lines or gradient arrows would point outward horizontally and inward vertically and go orthogonally over the diagonals. In the hexapole, the field points in from the left and out to the right, in from top-right and out to bottom-left, in from bottom-right and out to top-left. In general, we get a $2(n-1)$-th order pole for $n > 1$ and for the special case of $n = 1$, we get a monopole. In complex analysis, the function $1/z$ is generally a somewhat special citizen that stands out from the crowd of power functions. It is the odd one out in the context of Laurent series: the coefficient for $z^{-1}$ is so special that it even has its own name: the "residue". And if you remember from real calculus that $x^{-1}$ is the only power of $x$ for which the power rule of integrals $(x^{n+1}) / (n+1)$ fails to apply (as a programmer, I'd call its use here a division-by-zero error), it may be not so surprising to see the reciprocation function $1/z$ break a pattern yet again. 
\begin{figure}[p]
\caption{Polya potential contours of $f(z) = e^z, f(z) = \sinh(z), f(z) = \cosh(z)$}	
\label{Fig:ContoursExpSinhCosh}	
\centering
\begin{subfigure}[b]{0.32\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursExp.png}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursSinh.png}
\end{subfigure}
\begin{subfigure}[b]{0.32\textwidth}
\centering
\includegraphics[width=\textwidth]{../MathFigures/PolyaContoursCosh.png}
\end{subfigure}
\end{figure}


% z^n:  saddle of order n+1
% z^0:  straight lines, flat/planar field
% z^-1: monopole
% z^-n: 

% -Maybe mention that 1/x is its own inverse. That's also a somewhat special property although
%  it's not totally exclusive: -x and x are also their own inverses (involutions).

\subsection{Plots for Exponential, Trigonometric and Hyperbolic Functions}
A very important function in real analysis is the exponential function $f(x) = e^x$. It is the only function that is its own derivative. When splitting it into its symmetric and antisymmetric parts, one obtains the so called hyperbolic functions $\cosh(x), \sinh(x)$. If we take the exponential function as a function of a complex argument that produces a complex output, written as $f(z) = e^z$, we find interesting relationships between trigonometric and hyperbolic functions...TBC...

% I think, sin and cos would just be like sinh and cosh but rotated by 90°



% Ideas for including tall graphics:
% Put the image rotated into the document:
% https://latex.org/forum/viewtopic.php?t=9323
% https://tex.stackexchange.com/questions/101645/how-to-turn-latex-figure-by-90-degrees-along-with-the-caption
% Let the text flow next to the image:
% https://tex.stackexchange.com/questions/55161/how-to-arrange-image-and-text-to-appear-side-by-side

%\subsection{Plots for Polynomials}
% (z-1)(z+1), (z-1)(z+1)(z-i)
% I'm interested in the geodesic between the zeros of f (i.e. flat points of P) - what shape do they have?

%\subsection{Plots for Rational Functions}
% Moebius trafo, 

%\subsection{Plots for Roots and Logarithm}

%\subsection{Plots for Special Functions}
% Zeta, Lambert-W, Gamma, 


\section{Rules for Complicated Functions}
Having tables for the Polya potentials of some basic elementary functions is well and good but often we have to deal with more complicated functions. For a given function $f$, we could just plug it into the little Sage script and see, what it produces. What we will discover is that things get messy really quick. Of course they do - after all, we are dealing with integrals here. Maybe you can get something more reasonable with other CAS systems like Mathematica or manually with some integration wizardry if you are a Richard Feynman type of person. You could perhaps deal with products using integration by parts or deal with composite functions using substitutions. But I want to go down some other route here. I will assume that our function $f(z)$ is given as some sort of combination (product, quotient or composition) of two other functions $g(z), h(z)$ for which we know a power series expansion. I want to give formulas or algorithms to obtain a series expansion for $f$. This may actually be applicable in completely different contexts as well. From the so found series expansion of $f$, we can then find the corresponding Polya potential term-wise by using our tabulated expressions for simple functions like $z^n$. The setting is as follows:
\begin{equation}
g(z) = \sum_k a_k z^k, \quad
h(z) = \sum_m b_m z^m, \qquad
f(z) = \sum_n c_n z^n
\end{equation}
where the $a_k, b_m$ are known and we set out to figure out formulas or algorithms to compute the $c_n$ in terms of the known $a_k, b_m$. The function $f(z)$ is assumed to be given in terms of $g,h$ as a weighted sum $f(z) = a g(z) + b h(z)$, as product $f(z) = g(z) h(z)$, as quotient $f(z) = g(z) / h(z)$ or as composition $f(z) = g(h(z))$. I have deliberately kept the ranges of $k$ and $m$ ambiguous. They could go from zero to some finite number in which case we would be dealing with polynomials, from zero to infinity in which case we would be dealing with power series, from minus infinity to plus infinity in which case we would be dealing with Laurent series, etc.. The question is now: what would the coefficients $c_n$ of a series expansion of $f$ look like.

\subsection{Weighted Sums and Series}
The simplest case of that is when our function of interest $f$ is given by a weighted sum of functions whose potentials we already know, i.e. $f(z) = a g(z) + b h(z)$ for some constants $a,b$. In this case, the full potential is just the weighted sum of the individual potentials with the same weights as in $f$. This even extends to infinite weighted sums which is useful when we have a series expansion of our $f$ like, for example, a Taylor-, Laurent- or Fourier series. Polynomials are included as well as special case of Taylor series.

\subsection{Products}
Let's turn to products. The solution to that problem is actually well known: the sequence $c_n$ is given by the convolution of the sequences $a_k$ and $b_m$. Such a product of two given series expansions is also known as the Cauchy-Product of these series. So, to find a Polya potential of a product of two functions $g,h$ given as series expansions, we could construct a series expansion of $f$ using the Cauchy product, i.e. convolution, and then use the formulas for the Polya potentials of $z^n$ from our tables. 

\subsection{Quotients}
For a quotient $f(z) = g(z) / h(z)$, we would need to do a deconvolution. ...TBC...Give deconvolution algo (see my math book or the pdf-paper where I explain the algo), link to an implementation

\subsection{Composite Functions}
For a function $f$ that results from composing (aka nesting or chaining) two functions such that $f(z) = g(h(z))$, an algorithm for finding the $c_n$ could look as follows ....TBC...link to the DefiniteIntegration... paper on my website - it has such an algorithm. Maybe the stuff about combining series should be factored out into a separate paper 

% Maybe such a paper could be called "Power Series Arithmetic" or "Arithmetic Operations on Polynomials and Power Series". It should cover addition, subtraction, linear combination, multiplication (convolution), division (deconvolution), composition. Or maybe just do all of that in the math book. There, we actually already have everything except composition.

%A benign looking function such as \texttt{exp(z)*sin(z\textasciicircum2)} containing a multiplication and a composition, will produce very complicated expressions that even contain the \texttt{erf} erf function. But 

%that are formed from the basic functions by mathematical operations like multiplication, division and nesting. Addition and subtraction ins unproblematic because in this case, we can also just add or subtract the corresponding Polya potentials due to linearity.

% Give product, quotient and chain rule for power series (conv, deconv, polyNest)

% exp(z)*sin(z^2)                 long expresson, contains erf
% exp(z) / (1+ z^2)               even worse
% exp(z) / (1+ sin(z^2))          sage gives up
% Maybe some other CAS like Mathematica or an integration wizard like Richard Feynman could handle it....

% mention building Polya potententials from Talyor sereis, Laurent series, and Fourier series
% partial fraction expansions for rational functions

\subsection{Numerical Evaluation}
If all of our attempts to derive an analytic expression for the Polya potential of some function of interest fail, we may have no other choice than to turn to a numerical approximation. Inside my research codebase \cite{GitHub}, I written have a little function that takes as input a vector field represented as a pair of 2D arrays for $u(x,y)$ and $v(x,y)$ and produces as output a 2D array that represents the scalar field $P(x,y)$ whose numerical partial derivatives, computed via a central difference formula, match the given vector field data $u,v$. I explain the algorithm in \cite{PotentialNumerical}. Well, there is actually nothing computed via the central difference formula, but instead I use the central difference formula as an ansatz. I imagine that our given 2D arrays  $u,v$ have been computed by such a formula from an unknown scalar filed $P$ (also represented as 2D array) and then I ask, what the scalar field $P$ must look like to produce such numerical partial derivatives. That leads to an overdetermined linear system of equations for the elements of $P$ which I solve using a least squares approach. The systems grow big really fast, so it's mandatory to use a sparse matrix representation and solve the system by iterative methods. To this end, I have implemented SOR (successive over relaxation). It's sometimes horribly slow and sometimes even fails to converge. So, so far, this stuff is still in a rather preliminary shape. Also, the numerical error is quite visible. When doing contour plots of numerically computed potentials, the contour lines look very "noisy" compared to the ideal, mathematically correct contour lines. So, it's not a silver bullet and if we can, we should really try to figure out an analytic expression. Turning to the numerical algorithm should be the last resort.




% Old text snippet - obsolete?:
%In this context, the scalar field whose gradient our vector field is, is called the (scalar) potential of the vector field. In fact, the Jacobian of the vector field is just the Hessian of the potential. The potential for the Polya vector field of a complex function $f(z)$ is what I call the "Polya potential" of the complex function and it's an object that I have not yet seen as being used in complex analysis. Maybe taking a closer look at it can reveal some new insights. The goal is to derive expressions for the Polya potential of the zeta function and then analyze this Polya potential instead of the zeta function itself. I hope that it will turn out to be simpler to understand because its just a simple scalar field over $\mathbb{R}^2$, i.e. a 3D thing rather than a 4D one - but it contains nonetheless the same amount of information. We have taken advantage of the analyticity of zeta to achieve a dimensionality reduction of the problem. The all important zeros of the zeta function will be mapped to the stationary points of its Polya potential. Stationary points of a scalar field are points, where the gradient vanishes. In general, there are three types of such stationary poinrs: minima, maxima and saddle points. Experiments suggest that in the case of Polya potentials of complex functions, only saddles occur [I think, this might be a consequence of the additional divergence-free property - figure out!]. The Polya potential is a surface in 3D space, so it is also amenable to the tools of differential geometry like figuring out main curvature directions at the stationary points, figuring out the geodesics between the stationary points, etc.. Polya potentials give us a new angle of attack to analyze complex functions and, of course, to visualize them to hopefully build some intuition.

\begin{thebibliography}{9}
	
\bibitem{SageCell} SageCell, \textit{Online SageMath Evaluator,}
\href{https://sagecell.sagemath.org/}{sagecell.sagemath.org/}

\bibitem{GitHub} RS-MET-Research, \textit{Repository on GitHub}
\href{https://github.com/RobinSchmidt/RS-MET-Research}{github.com/RobinSchmidt/RS-MET-Research}

\bibitem{PotentialNumerical} PotentialNumerical.txt, \textit{File in my research repo,}
\href{https://github.com/RobinSchmidt/RS-MET-Research/blob/master/Notes/PotentialNumerical.txt}{Notes/PotentialNumerical.txt}

\bibitem{MonkeySaddleWiki} Monkey Saddle, \textit{Wikipedia article,}
\href{https://wikipedia.org/wiki/Monkey_saddle}{wikipedia.org/Monkey\_saddle}

\bibitem{HighOrderSaddles} Monkey, Starfish and Octopus Saddles, \textit{Scott Dale Peckham,}
\href{https://www.researchgate.net/publication/256808897_Monkey_Starfish_and_Octopus_Saddles	}{https://www.researchgate.net/publication/256808897\_Monkey\_Starfish\_and\_Octopus\_Saddles}

%http://rs-met.com/documents/dsp/DefiniteIntegrationOfPolynomialsWithPolynomialsAsLimits.pdf

\end{thebibliography}
 
 
\end{document}



\begin{comment}
	
Notes:

ToDo:

-For every function whose plot we explain, also give the formulas for z,u,v,P in the same format 
 as in the beginning of the paper or maybe without u,v. More like in the case of 1/z, 1/z^2
-Use paragraphs for each function instead od medskips

-Verify the code to produce the images numerically by computing a numerical gradient of the
 Polya potenetial to an actual evaluation of the function. Maybe implement it as a unit test.
 Test also the analytic computation of the Polya vector field. We have the function
 testPolyaPotentialFormulas
 
-Add tables for Polya potentials of positive powers of z in this verbatim text format.
 At the moment, we have only expressions for the Polya vector fields for z^n, n > 0

-Explain the difference in P(x,y) for f(i z) and i f(z), i.e. pre- or post rotation by 90°. 
 Will it give the same result? If not, why not? Give general rules for rotating a potential.
 Example exp(z):
   exp(  z)   ->   exp( x) * cos( y)
   exp(i z)   ->   sin( x) * exp(-y)
 i exp(z  )   ->  -exp(-x) * sin( y)
 i exp(i z)   ->   cos( x) * exp(-y)
 They are all different. Try also variants using -i and -1 as (pre- and post) factors. When
 there's an i in the argument, the exponential goes along the y-axis. I think, rotation is 
 done by multiplying the input by i.
 
-Maybe give expressions for c z^n and (c z)^n for complex c. Maybe given them in polar
 coordinates, too. Maybe plot the Polya potentials in polar coordinates. I mean, let's show a 
 polar grid and truncate the graph to a circle at some radius rather than to a rectangle.
 "set grid polar 30.0000 lw 1.5"
 https://stackoverflow.com/questions/74844744/gnuplot-set-angular-grid-limits-in-polar-plot

-The placement of the plots in the document makes no sense when using the placement  option h
 for all plots. How can we convince LaTeX to place them where they belong? Maybe we need to make
 a special appendix for the figures.
 https://www.overleaf.com/learn/latex/Positioning_images_and_tables
 ..hmm...OK - placing some with h and some with p seems to give reasonable results. I think,
 whenever we have a lot of plots in quick succession, it makes sens to use p whereas for a
 plot that occurs sporadically within a lot of text, h seems to give better results. Maybe try 
 also the option H which really enforces the "here" placement.
 
-Write a "Conclusion" section that hints at the implementation for numerically computing 
 potentials. Use that implementation to produce plots of the Polya potentials of sqrt and log.
-Don't use z for the height as in z = P(x,y) when we already use z as argument to f = f(z). The
 letter z means different things in these two situations which is a clash of notation. Maybe use 
 P instead of z, i.e. write P = P(x,y) - done
-Mention that the  polynomials for u,v,P are homogeneous. All terms have the same degree
-Figure out expressions for u,v,P in polar coordinates, i.e. P(r,a) instead of P(x,y). 
 Maybe in polar coordinates, we may get expressions for P for log, sqrt, etc.? The wikipedia 
 article about the monkey saddle gives the formula cos(3*a)/r^3. We would need the pre-factor 
 1/3 here. Maybe in general, for z^n, the formula is P(r,a) = cos((n+1) a) / ((n+1) r^(n+1))?
-We could also express the output in polar coordinates, i.e. have two functions:
 d(r, phi), psi(r, phi) where d stands for distance. In the case of f(z) = z^n, we would have 
 d(r, phi) = r^n, psi(r, phi) = n phi. In the Polya vector field, we would just negate psi, I 
 think. Now we could use P(r, phi) = r^(n+1) / (n+1) + (n/2) phi^2 as potential in terms of r 
 and phi, i.e. the polar coordinates of z. That would give the desired partial derivatives wrt 
 to r and phi. -> Try it out! It would simplify the computation of Polya potentials of powers 
 of z and may also enable us to find expressions for sqrt(z), log(z), z^c for arbitrary real 
 or complex c, etc.
-What are the Cauchy-Riemann equations in polar coordinates?
 
-What is the Polya potential for a function a z^n? I think, if a is real, we can just multiply
 the Polya potential of z^n by the same a. But what if a is complex? Maybe we need to multiply
 the result by |a| but in addtion, before feeding x,y into the bivariate polynomial, we need to
 apply a rotation by the angle of a to x,y? Figure out! Try it with a = 2 + i or 4 + 3i.
-Mention that the polynomials for P(x,y) for z^n are homogeneous which means that the total
 grade of each term is the same, namely n+1.
-I think, the u(x,y), v(x,y) functions for z^n are themselves also (higher order) saddles. Is 
 it generally true that the partial derivatives of a saddle are again saddles with order one 
 less?
 
-I think, our Polya potential satisfies the Laplacian equation P_xx + P_yy = 0. That's an
 immediate consequence of the divergence free property of the vector field.
 
-Investigate the impact of poles and zeros on geometric features such as the equipotential
 curves and geodesics between interesting points (e.g. the saddles)

-Derive some general features of the Hessian of Polya-potentials. A general 2x2 matrix looks 
 like [a,b; c,d] so it has 4 degrees of freedom. But Hessians are symmetric, so c=b, so we have
 only 3 degrees of freedom for general Hessians. But Polya potentials have more constraints. I think
 the Laplacian equation becomes P_yy + P_xx = 0, so a = -d. I think, we also have that the 
 determinant is zero such that a*d - b*c = 0. That's the observation that we always see saddles and
 never minima or maxima. But I'm not sure, how to derive that constraint. It must have something to
 do with the divergence-free property of the gradient of P, I think. Look at the Cauchy-Riemann
 equations. One of them or maybe both can perhaps be used to derive the constraint. That would leave
 The Hessian with only 1 degree of freedom. It would look like [a,b; b,-a] with the constraint
 a * -a - b*b = 0 = -a^2 - b^2 -> a^2 + b^2 = 0. ...wait...that cannot be correct! It would mean
 that a=b=0 because a,b are both real. But maybe that's indeed the case. It doesn't have to be the 
 case everywhere - only at the stationary points. Maybe at these, the Hessian is indeed the zero 
 matrix? That would mean, the function is very flat there. Try it numerically with f(z) = z^5.
 Generate the Polya potential for it in the C++ code. Maybe we should really list the Polya 
 potentials for z^n up to n=7 or so here. We have the general formulas already - but they are 
 unwieldy to evaluate, so let's include some more evaluated ones. See Notes/ComplexPotential.txt
 for producing them. But maybe include them in the table on page 4. For w = z^5, the Polya potential 
 is:  P(x,y) = 1/6*x^6 - 5/2*x^4*y^2 + 5/2*x^2*y^4 - 1/6*y^6
 
-Apparently, for f(z) = z^n, all entries of the Hessian are zero at z=0. This can be seen from the 
 fact that all terms have multipliers x and/or y in them. But will this really always be the case?
 If so, we would have found a justification why only saddles may occur for functions of the for z^n
 and therefore (by linearity) also for polynomials and power series (I think). But couldn't it 
 happen that in the elements of the Hessian, we encounter polynomials with constant terms? This 
 would require in the Polya vector field to have terms that just contain an x^1 or an y^1. I think,
 that does indeed never happen.
 
-Try to make general statements about the eigenvalues and eigenvectors of the Hessian. I think, at
 the saddle points, these eigenvalues are both zero because the Hessian itself is zero?
 
-Maybe try a function like f(z) = (z-1)*(z+1)*(z-i)*(z+i) 

Resources:
https://en.wikipedia.org/wiki/Scalar_potential	
https://en.wikipedia.org/wiki/Saddle_point#Surface
https://en.wikipedia.org/wiki/Hyperbolic_geometry	
	
	
-This paper is supposed to factor out all the general Polya-potential stuff from the paper
 about the Polya potential of the Riemann zeta function such that it can eventually be removed
 from there.
 
-Give plots for Polya potentials for some simple functions
 f(z) = c, f(z) = z, f(z) = z + c, f(z) = z^2
 
-Write a follow-up paper "Polya Potentials through the Lens of Differential Geometry" or
 "On the Differential Geometry of Polya Potentials"
 
-Write a paper "Polya Potentials of Rational Functions"
 
-Polya potentials P(x,y) satisfy the equation P_x + P_y = 0. This is due to the divergence free
 property of Polya vector fields. Can we deduce some facts about the differential geometry of
 P(x,y) from that? ...wait - no - they satisfy P_xx + P_yy = 0. The Laplace equation.

-We may differentiate the equation wrt x and y to obtain the two equations:
 P_{xx} + P_{yx} = 0, P_{xy} + P_{yy} = 0 which implies P_{xx} = -P_{xy} = P_{yy} when we 
 assume P_{xy} = P_{yx} due to Schwartz's theorem (which we may due to analyticity). From that
 equality, we may be able to derive some constraints for the metric tensor.

-What about viewing Polya potentials through the lens of algebraic geometry by considering the
 curves P(x,y) = c for some constant c? What about P(x,y) = Q(x,y) for two given Polya potentials
 P,Q?
 
-Doesn't the divergence-free property, which is another as of yet unused constraint, imply that
 we can boil the information one dimension further? If so, how? I mean, a function must output
 something, so we can't boil down the output dimension any further. The only possible way is to
 boild down the input. I mean - yes - it is indeed well known that a function defined on the 
 reals uniquely determines a complex function by way of analytic continuation. Actually, even 
 any finite chunk of the real line - or any other line or curve determines it. Maybe the most
 useful thing to think about it is that we may *select* a part of the function for plotting that
 shows the most interesting features - for example, the Riemann zeta function for x = 1/2 and
 y in R. Maybe plot the potential of zeta along this line. It should give a function R -> R 
 whose saddles occur at th imaginary parts of the zeros of zeta. See also:
   https://mathworld.wolfram.com/Xi-Function.html
 It's also a function R -> R that shows the zeta zeros.

-What about expressing the polar potential in polar coordinates? Maybe the higher order saddles
 from f(z) = z^n  are given by P(r,phi) = r^n * cos(n * phi), See:
 https://en.wikipedia.org/wiki/Monkey_saddle
 Maybe that cghange of coordinates can help us to find Polya potentials of the more difficult 
 functions like sqrt(z). ln(z), etc.? But let's first try it with the simpler z^n case starting
 with z^2.

-
 
-Todo: 
 -analyze geometry of: equipotentials, geodesics between saddles
 -investigate impact of poles and zeros on the geometries
 -maybe look at the Polya potential of Riemann's zeta function but with the pole canceled out by
  multiplying the function by (z-1). That should remove the pole at z=1. Maybe the pole would 
  distort an otherwise nice geometry of the geodesics?
 
See also:

ZetaPotential.tex                            
-has some more Sage code and output that perhaps belongs here. There we really don't want to have
 all that Sage code for the general Polya potential stuff. It has been factored out into this 
 paper.

RS-MET-Research/Notes/ComplexPotential.txt   
-has a bit more draft Sage code



\end{comment}
